<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org" th:fragment="layout" xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
    <title th:text="${titulo}"></title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
          crossorigin="anonymous" referrerpolicy="no-referrer" />

    <meta charset="UTF-8">

    <link rel="stylesheet" th:href="@{/css/base.css}" />
    <link rel="stylesheet" th:href="@{/css/header.css}" />
    <link rel="stylesheet" th:href="@{/css/footer.css}" />

    <div th:replace="${css} :: css"></div>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

</head>

<!--Para los popups-->
<script th:if="${mensaje}">
    document.addEventListener('DOMContentLoaded', function () {
        var el = document.getElementById('flashToast');
        if (el && window.bootstrap && bootstrap.Toast) {
            new bootstrap.Toast(el, { delay: 4000 }).show();
        }
    });
</script>

<body>

<!-- Header Principal -->
<header class="main-header --public">
    <a class="logo" th:href="@{/inicio}" aria-label="Ir al inicio"> MetaMapa</a>
    <nav>
        <ul>
            <li sec:authorize="!isAuthenticated()">
                <a th:href="@{/login}">Iniciar Sesi贸n</a>
            </li>
            <!-- Si S est谩 autenticada: saludo + bot贸n de logout -->
            <li sec:authorize="isAuthenticated()" style="color:#fff; opacity:.9;">
                Hola, <span sec:authentication="name"></span>
            </li>
            <li sec:authorize="isAuthenticated()" style="list-style:none;">
                <form th:action="@{/logout}" method="post" style="display:inline;">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                    <button type="submit" class="btn btn-sm btn-outline-danger">
                        <i class="fa-solid fa-right-from-bracket"></i> Cerrar sesi贸n
                    </button>
                </form>
            </li>

        </ul>
    </nav>
</header>


<div th:replace="${contenido} :: contenido"></div>


<!-- Para popups -->
<div aria-live="polite" aria-atomic="true" class="position-fixed top-0 end-0 p-3" style="z-index:1100;"
     th:if="${mensaje}">
    <div id="flashToast"
         class="toast align-items-center"
         role="alert" aria-live="assertive" aria-atomic="true"
         th:classappend="${tipoMensaje}=='success' ? ' text-bg-success' : ' text-bg-danger'">
        <div class="d-flex">
            <div class="toast-body" th:text="${mensaje}">Operaci贸n realizada.</div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Cerrar"></button>
        </div>
    </div>
</div>

<footer class="site-footer">
    <div class="footer-container">
        <!-- Columna 1 -->
        <div class="footer-col">
            <h4>Informaci贸n</h4>
            <ul>
                <li><a th:href="@{/privacidad}">Informaci贸n Legal & Privacidad</a></li>
                <li><a href="#">Preguntas Frecuentes</a></li>
            </ul>
        </div>

        <!-- Columna 2 -->
        <div class="footer-col">
            <h4>Contacto</h4>
            <ul class="contact-list">
                <li><i class="fa-regular fa-envelope"></i>
                    <a href="mailto:info@metamapa.com">info@metamapa.com</a>
                </li>
                <li><i class="fa-solid fa-phone"></i>
                    <a href="tel:+1234567890">+11 3456 7890</a>
                </li>
                <li class="muted">Horario: Lunes - Viernes, 9:00 - 17:00</li>
            </ul>
        </div>

        <!-- Columna 3 -->
        <div class="footer-col">
            <h4>Seguinos</h4>
            <div class="socials">
                <a href="#" aria-label="Facebook"><i class="fa-brands fa-facebook-f"></i></a>
                <a href="#" aria-label="Instagram"><i class="fa-brands fa-instagram"></i></a>
                <a href="#" aria-label="LinkedIn"><i class="fa-brands fa-linkedin-in"></i></a>
            </div>
        </div>

        <!-- Columna 4 -->
        <div class="footer-col">
            <h4>MetaMapa</h4>
            <p class="about">Ofreciendo soluciones innovadoras para un futuro conectado.</p>
            <p class="muted">漏 2025 MetaMapa. Todos los derechos reservados.</p>
        </div>
    </div>
</footer>
</body>
</html>